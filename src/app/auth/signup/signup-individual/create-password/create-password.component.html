<div class="flex items-center mb-4">
    <span class="p-2 bg-white rounded-lg border border-gray-200">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 11H5C3.89543 11 3 11.8954 3 13V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V13C21 11.8954 20.1046 11 19 11Z" stroke="#6366F1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11" stroke="#6366F1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            
    </span>
</div>
<h1 class="text-2xl font-semibold text-gray-800 mb-2">{{ title | translate }}</h1>
<p class="text-gray-500 mb-6 text-md">{{ subtitle | translate }}</p>

<form [formGroup]="passwordForm" (ngSubmit)="onNextStep()">
    <!-- Password Field -->
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-1" for="password">{{ 'FIELDS.PASSWORD' | translate }}</label>
        <div class="relative">
            <input
                formControlName="password"
                class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:border focus:border-primary-300"
                [ngClass]="{
                    'border-gray-200': !isFieldInvalid('password'),
                    '!border-red-500': isFieldInvalid('password')
                }"
                id="password" 
                [placeholder]="'PLACEHOLDERS.PASSWORD' | translate" 
                [type]="showPassword ? 'text' : 'password'" />
            <button
                type="button"
                (click)="togglePasswordVisibility()"
                class="text-gray-400 absolute top-1/2 p-2 end-0 translate-y-[-50%]"
            >
                <!-- svg eye slash -->
                @if (showPassword) {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-slash"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle><path d="M2 2l20 20"></path></svg>
                <!-- svg eye -->
                }@else {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                }
            </button>
        </div>
        
        <!-- Password Strength Indicator -->
        <div *ngIf="passwordForm.get('password')?.value" class="mt-3">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-semibold text-gray-800">{{ 'CREATE_PASSWORD.LEVEL' | translate }}: {{ getPasswordStrengthTranslation() }}</span>
            </div>
            <div class="flex gap-1">
                <div class="flex-1 h-2 rounded-sm transition-all duration-300"
                     [ngClass]="{
                         'bg-primary-500': getPasswordStrength() === 'weak' || getPasswordStrength() === 'medium' || getPasswordStrength() === 'strong',
                         'bg-gray-300': getPasswordStrength() === ''
                     }">
                </div>
                <div class="flex-1 h-2 rounded-sm transition-all duration-300"
                     [ngClass]="{
                         'bg-primary-500': getPasswordStrength() === 'medium' || getPasswordStrength() === 'strong',
                         'bg-gray-300': getPasswordStrength() === 'weak' || getPasswordStrength() === ''
                     }">
                </div>
                <div class="flex-1 h-2 rounded-sm transition-all duration-300"
                     [ngClass]="{
                         'bg-primary-500': getPasswordStrength() === 'strong',
                         'bg-gray-300': getPasswordStrength() === 'weak' || getPasswordStrength() === 'medium' || getPasswordStrength() === ''
                     }">
                </div>
                <div class="flex-1 h-2 rounded-sm transition-all duration-300"
                     [ngClass]="{
                         'bg-primary-500': getPasswordStrength() === 'strong',
                         'bg-gray-300': getPasswordStrength() === 'weak' || getPasswordStrength() === 'medium' || getPasswordStrength() === ''
                     }">
                </div>
            </div>
        </div>
        
        <!-- Password Requirements -->
        <div *ngIf="passwordForm.get('password')?.value" class="mt-4">
            <h3 class="text-sm font-semibold text-gray-800 mb-3">{{ 'CREATE_PASSWORD.REQUIREMENTS_TITLE' | translate }}</h3>
            <div class="space-y-2">
                <div class="flex items-center">
                    <div class="w-4 h-4 mr-3 flex items-center justify-center">
                        <svg *ngIf="hasMinLength()" class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <svg *ngIf="!hasMinLength()" class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <span class="text-sm" [ngClass]="hasMinLength() ? 'text-green-600' : 'text-gray-600'">
                        {{ 'CREATE_PASSWORD.REQUIREMENTS_TEXT.MIN_LENGTH' | translate }}
                    </span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 mr-3 flex items-center justify-center">
                        <svg *ngIf="hasLowercase()" class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <svg *ngIf="!hasLowercase()" class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <span class="text-sm" [ngClass]="hasLowercase() ? 'text-green-600' : 'text-gray-600'">
                        {{ 'CREATE_PASSWORD.REQUIREMENTS_TEXT.LOWERCASE' | translate }}
                    </span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 mr-3 flex items-center justify-center">
                        <svg *ngIf="hasUppercase()" class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <svg *ngIf="!hasUppercase()" class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <span class="text-sm" [ngClass]="hasUppercase() ? 'text-green-600' : 'text-gray-600'">
                        {{ 'CREATE_PASSWORD.REQUIREMENTS_TEXT.UPPERCASE' | translate }}
                    </span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 mr-3 flex items-center justify-center">
                        <svg *ngIf="hasNumber()" class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <svg *ngIf="!hasNumber()" class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <span class="text-sm" [ngClass]="hasNumber() ? 'text-green-600' : 'text-gray-600'">
                        {{ 'CREATE_PASSWORD.REQUIREMENTS_TEXT.NUMBER' | translate }}
                    </span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 mr-3 flex items-center justify-center">
                        <svg *ngIf="hasSpecialChar()" class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <svg *ngIf="!hasSpecialChar()" class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <span class="text-sm" [ngClass]="hasSpecialChar() ? 'text-green-600' : 'text-gray-600'">
                        {{ 'CREATE_PASSWORD.REQUIREMENTS_TEXT.SPECIAL_CHAR' | translate }}
                    </span>
                </div>
            </div>
        </div>
        
        <div *ngIf="isFieldInvalid('password')" class="mt-1 text-xs text-red-600">
            {{ getFieldError('password') }}
        </div>
    </div>

    <!-- Confirm Password Field -->
    <div class="mb-4">
        <label class="mb-1" for="confirm-password">
            <span class="text-sm font-medium text-gray-700">{{ 'FIELDS.CONFIRM_PASSWORD' | translate }}</span>
        </label>
        <div class="relative">
            <input
                formControlName="confirmPassword"
                class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:border focus:border-primary-300"
                [ngClass]="{
                    'border-gray-200': !isFieldInvalid('confirmPassword'),
                    '!border-red-500': isFieldInvalid('confirmPassword')
                }"
                id="confirm-password" 
                [placeholder]="'PLACEHOLDERS.CONFIRM_PASSWORD' | translate" 
                [type]="showConfirmPassword ? 'text' : 'password'" />
            <button
                type="button"
                (click)="toggleConfirmPasswordVisibility()"
                class="text-gray-400 absolute top-1/2 p-2 end-0 translate-y-[-50%]"
            >
                <!-- svg eye slash -->
                @if (showConfirmPassword) {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-slash"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle><path d="M2 2l20 20"></path></svg>
                <!-- svg eye -->
                }@else {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                }
            </button>
        </div>
        <div *ngIf="isFieldInvalid('confirmPassword')" class="mt-1 text-xs text-red-600">
            {{ getFieldError('confirmPassword') }}
        </div>
    </div>

    <!-- Submit Button -->
    <button
        class="btn-primary"
        type="submit"
        [disabled]="passwordForm.invalid">
        {{ buttonText | translate }}
    </button>
    
    <!-- Previous Button -->
    @if (isShowPreviousButton) {
    <div class="mt-4">
        <a class="text-primary-700 cursor-pointer hover:text-primary-800 font-semibold flex items-center justify-center"
            (click)="onPreviousStep()">
            <span class=" mx-2 rtl:rotate-180">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 19L8 12L15 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </span>
            {{ 'BUTTONS.PREVIOUS' | translate }}
        </a>
    </div>
    }
</form>