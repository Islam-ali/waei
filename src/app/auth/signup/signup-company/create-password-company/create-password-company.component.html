<div class="flex items-center mb-6">
    <span class="p-4 bg-white rounded-lg border border-gray-200">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 11H5C3.89543 11 3 11.8954 3 13V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V13C21 11.8954 20.1046 11 19 11Z" stroke="#6366F1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11" stroke="#6366F1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            
    </span>
</div>
<h1 class="text-3xl font-bold text-gray-800 mb-2">{{ 'CREATE_PASSWORD.TITLE' | translate }}</h1>
<p class="text-gray-500 mb-8">{{ 'CREATE_PASSWORD.SUBTITLE' | translate }}</p>

<form [formGroup]="passwordForm" (ngSubmit)="onNextStep()">
    <!-- Password Field -->
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-1" for="password">{{ 'FIELDS.PASSWORD' | translate }}</label>
        <div class="relative">
            <input
                formControlName="password"
                class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-700"
                [ngClass]="{
                    'border-gray-300': !isFieldInvalid('password'),
                    'border-red-500': isFieldInvalid('password')
                }"
                id="password" 
                [placeholder]="'PLACEHOLDERS.PASSWORD' | translate" 
                [type]="showPassword ? 'text' : 'password'" />
            <button
                type="button"
                (click)="togglePasswordVisibility()"
                class="text-gray-400 absolute top-1/2 p-2 end-0 translate-y-[-50%]"
            >
                <!-- svg eye slash -->
                @if (showPassword) {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-slash"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle><path d="M2 2l20 20"></path></svg>
                <!-- svg eye -->
                }@else {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                }
            </button>
        </div>
        
        <!-- Password Strength Indicator -->
        <div *ngIf="passwordForm.get('password')?.value" class="mt-2">
            <div class="flex items-center space-x-2">
                <span class="text-xs text-gray-600">{{ 'CREATE_PASSWORD.STRENGTH_LABEL' | translate }}:</span>
                <span class="text-xs font-medium" [ngClass]="getPasswordStrengthColor()">
                    {{ getPasswordStrength() | titlecase }}
                </span>
            </div>
            <div class="mt-1 w-full bg-gray-200 rounded-full h-1.5">
                <div class="h-1.5 rounded-full transition-all duration-300"
                     [ngClass]="{
                         'bg-red-500 w-1/3': getPasswordStrength() === 'weak',
                         'bg-yellow-500 w-2/3': getPasswordStrength() === 'medium',
                         'bg-green-500 w-full': getPasswordStrength() === 'strong'
                     }">
                </div>
            </div>
        </div>
        
        <!-- Password Requirements -->
        <div *ngIf="passwordForm.get('password')?.value && isFieldInvalid('password')" class="mt-2 text-xs text-gray-600">
            <div class="space-y-1">
                <div class="flex items-center">
                    <span class="w-1 h-1 rounded-full mr-2"
                          [ngClass]="hasMinLength() ? 'bg-green-500' : 'bg-gray-300'"></span>
                    {{ 'CREATE_PASSWORD.REQUIREMENTS.MIN_LENGTH' | translate }}
                </div>
                <div class="flex items-center">
                    <span class="w-1 h-1 rounded-full mr-2"
                          [ngClass]="hasUppercase() ? 'bg-green-500' : 'bg-gray-300'"></span>
                    {{ 'CREATE_PASSWORD.REQUIREMENTS.UPPERCASE' | translate }}
                </div>
                <div class="flex items-center">
                    <span class="w-1 h-1 rounded-full mr-2"
                          [ngClass]="hasLowercase() ? 'bg-green-500' : 'bg-gray-300'"></span>
                    {{ 'CREATE_PASSWORD.REQUIREMENTS.LOWERCASE' | translate }}
                </div>
                <div class="flex items-center">
                    <span class="w-1 h-1 rounded-full mr-2"
                          [ngClass]="hasNumber() ? 'bg-green-500' : 'bg-gray-300'"></span>
                    {{ 'CREATE_PASSWORD.REQUIREMENTS.NUMBER' | translate }}
                </div>
                <div class="flex items-center">
                    <span class="w-1 h-1 rounded-full mr-2"
                          [ngClass]="hasSpecialChar() ? 'bg-green-500' : 'bg-gray-300'"></span>
                    {{ 'CREATE_PASSWORD.REQUIREMENTS.SPECIAL_CHAR' | translate }}
                </div>
            </div>
        </div>
        
        <div *ngIf="isFieldInvalid('password')" class="mt-1 text-sm text-red-600">
            {{ getFieldError('password') }}
        </div>
    </div>

    <!-- Confirm Password Field -->
    <div class="mb-4">
        <label class="mb-1" for="confirm-password">
            <span class="text-sm font-medium text-gray-700">{{ 'FIELDS.CONFIRM_PASSWORD' | translate }}</span>
        </label>
        <div class="relative">
            <input
                formControlName="confirmPassword"
                class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-700"
                [ngClass]="{
                    'border-gray-300': !isFieldInvalid('confirmPassword'),
                    'border-red-500': isFieldInvalid('confirmPassword')
                }"
                id="confirm-password" 
                [placeholder]="'PLACEHOLDERS.CONFIRM_PASSWORD' | translate" 
                [type]="showConfirmPassword ? 'text' : 'password'" />
            <button
                type="button"
                (click)="toggleConfirmPasswordVisibility()"
                class="text-gray-400 absolute top-1/2 p-2 end-0 translate-y-[-50%]"
            >
                <!-- svg eye slash -->
                @if (showConfirmPassword) {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-slash"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle><path d="M2 2l20 20"></path></svg>
                <!-- svg eye -->
                }@else {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                }
            </button>
        </div>
        <div *ngIf="isFieldInvalid('confirmPassword')" class="mt-1 text-sm text-red-600">
            {{ getFieldError('confirmPassword') }}
        </div>
    </div>

    <!-- Terms and Conditions -->
    <div class="flex items-start mb-6">
        <input 
            formControlName="acceptTerms"
            class="h-4 w-4 text-primary-700 focus:ring-primary-700 border-gray-300 rounded mt-1" 
            id="terms"
            type="checkbox" />
        <label class="ml-2 block text-sm text-gray-600" for="terms">
            {{ 'YOUR_DETAILS.TERMS_TEXT' | translate }} <a class="font-medium text-gray-900 underline" href="#">{{ 'YOUR_DETAILS.TERMS_LINK' | translate }}</a> {{ 'YOUR_DETAILS.AND' | translate }} <a class="font-medium text-gray-900 underline" href="#">{{ 'YOUR_DETAILS.PRIVACY_LINK' | translate }}</a>.
        </label>
    </div>
    <div *ngIf="isFieldInvalid('acceptTerms')" class="mb-4 text-sm text-red-600">
        {{ getFieldError('acceptTerms') }}
    </div>

    <!-- Submit Button -->
    <button
        class="w-full bg-primary-700 text-white font-bold py-3 px-4 rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-700 focus:ring-opacity-50 disabled:bg-gray-400 disabled:cursor-not-allowed"
        type="submit"
        [disabled]="passwordForm.invalid">
        {{ 'BUTTONS.CREATE_ACCOUNT' | translate }}
    </button>
    
    <!-- Previous Button -->
    <div class="mt-6">
        <a class="text-primary-700 cursor-pointer hover:text-primary-800 font-semibold flex items-center justify-center"
            (click)="onPreviousStep()">
            <span class=" mx-2 rtl:rotate-180">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 19L8 12L15 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </span>
            {{ 'BUTTONS.PREVIOUS' | translate }}
        </a>
    </div>
</form>